# Опыт установки сервере Matrix Synapse.

Matrix — открытый протокол мгновенного обмена сообщениями. Synapse - эталонная реализация сервера для протокола.
За время использования сервера успел сделать несколько ошибок и перенести пару раз сервер с хоста на хост. Хочется поделиться своим опытом.

## Используйте для сервера Matrix отдельное доменное имя

Это даёт гибкость и, возможно, избавит вас от проблем в будущем. Если сегодня ваш сайт и сервер Matrix работают на одном сервере,
то в будущем, возможно, понадобится необходимость перенести Synapse на другую машину. Имея отдельное доменное имя можно сократить
простой работы Synapse до минимума.

Пример:

@ A 1.1.1.1
www A 1.1.1.1
matrix A 1.1.1.1
_matrix._tcp SRV matrix.example.com.

В случае необходимости вы легко можете изменив только одну запись matrix перенести сервер на другую машину. При этом сайт на основном домене может оставаться на своём месте.

## Используйте в качестве фронтэнда nginx

Это позволит упростить работу с сертификатами доменов, т.к. нет необходимости что-то прописывать в настройках synapse, использовать nginx в качестве прокси при переносе сервера synapse на другой IP адрес, т.е. уменьшить время простоя.

Если вы используете на фронтенде nginx, то нет необходимости разбираться с настройками сертификатов непосредственно в synapse, как их получать, куда их размещать. Используя nginx, вы можете использовать имеющийся опыт работы с сертификатами на других веб-серверах, либо получить этот опыт на своём Matrix-сервере и использовать его при настройке других сервисов. Получение сертификата для домена, например, с Let's Encrypt, легко автоматизируется в nginx. При этом если вы захотите перенести свой synapse на другую машину, то достаточно будет на nginx прописать настройки прокси, а сертификат необходимый у вас уже будет настроен и доступен. Нужно лишь немного изменить настройку виртуального хоста в nginx на вашей старой машине.
